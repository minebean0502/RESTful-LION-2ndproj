<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<meta charset="UTF-8">
<link rel="stylesheet" href="/static/css/header.css">
<header>
    <!-- ë¶€íŠ¸ ìŠ¤íŠ¸ë© ì„¸íŒ…ë„ on -->
    <div class="nav-bar">
        <a href="/main" class="logo">ë©”ì¸</a>
        <!-- ë‚˜ì¤‘ì— ë¡œê³ ì— ì•„ì´ì½˜ ë§í¬ì‹œí‚¤ê¸° -->
<!--        <ul class="nav-menu">-->
<!--            <li><a href="/hotel">í˜¸í…”</a></li>-->
<!--            <li><a href="/foods">ë§›ì§‘</a></li>-->
<!--            &lt;!&ndash; ì¶”ê°€ ë©”ë‰´ í•­ëª© &ndash;&gt;-->
<!--        </ul>-->

        <div class="nav-user-info" id="navUserInfo">
            <!--            &lt;!&ndash; ì‚¬ìš©ì ì´ë¦„, ë¡œê·¸ì¸ ìƒíƒœ, ì¥ë°”êµ¬ë‹ˆ ë“±ì˜ ì•„ì´ì½˜ &ndash;&gt;-->
            <!--            &lt;!&ndash; ì‚¬ìš©ì ì´ë¦„ &ndash;&gt;-->
            <!--            <span class="nickname">ì‚¬ìš©ìëª…</span>-->
            <!--            &lt;!&ndash; ì‚¬ìš©ì ìƒíƒœ &ndash;&gt;-->
            <!--            &lt;!&ndash; íšŒì› // í˜¸í…” ë§¤ë‹ˆì € // ê´€ë¦¬ìì—ë”°ë¼ ë‹¤ë¥´ê²Œ ë³´ì—¬ì£¼ê¸° &ndash;&gt;-->
            <!--            <span class="user-role">íšŒì›</span>-->
            <!--            &lt;!&ndash; ì•„ì´ì½˜ ì˜ˆì‹œ &ndash;&gt;-->
            <!--            <a href="/cart"><i class="cart-icon">ğŸ›’</i></a>-->
            <!--            <a href="/my-page"><i class="profile-icon">ğŸ‘¤</i></a>-->
            <!-- ... -->
        </div>
    </div>
</header>
<script>
    async function fetchLoginInfo() {
        const response = await fetch('/api/auth/login-info');
        const navUserInfoDiv = document.getElementById('navUserInfo');

        if (response.ok) {
            const data = await response.json();

            const nicknameHref = document.createElement('a');
            nicknameHref.href = '/my-page';
            nicknameHref.style.textDecoration = 'none';
            nicknameHref.style.color = 'black';
            nicknameHref.innerHTML = `<span class="nickname">${data.nickname}</span>`;

            const userRoleSpan = document.createElement('span');
            userRoleSpan.classList.add('user-role');

            let role = '';
            let additionalHref = null;
            if (data.role === 'ROLE_USER') {
                role = 'íšŒì›';
            }
            else if (data.role === 'ROLE_MANAGER') {
                role = 'ë§¤ë‹ˆì €';
                const managementHref = document.createElement('a');
                managementHref.href = '/hotel/management';
                managementHref.innerText = 'í˜¸í…” ê´€ë¦¬';
                managementHref.classList.add('text-menu');
                additionalHref = managementHref;
            }
            else if (data.role === 'ROLE_ADMIN') {
                role = 'ê´€ë¦¬ì';
                const dashboardHref = document.createElement('a');
                dashboardHref.href = '/admin';
                dashboardHref.innerText = 'ëŒ€ì‹œë³´ë“œ';
                dashboardHref.classList.add('text-menu');
                additionalHref = dashboardHref;
            }
            userRoleSpan.innerText = role;

            const logoutHref = document.createElement('a');
            logoutHref.href = '/logout';
            logoutHref.innerText = 'ë¡œê·¸ì•„ì›ƒ';
            logoutHref.classList.add('text-menu');

            navUserInfoDiv.appendChild(nicknameHref);
            navUserInfoDiv.appendChild(userRoleSpan);
            if (additionalHref != null) navUserInfoDiv.appendChild(additionalHref);
            navUserInfoDiv.appendChild(logoutHref);
        } else {
            const loginHref = document.createElement('a');
            loginHref.href = '/login';
            loginHref.innerText = 'ë¡œê·¸ì¸';
            loginHref.classList.add('text-menu');
            navUserInfoDiv.appendChild(loginHref);
        }

        // // ê°€ë¡œ ë§ˆì§„ ê°’ì„ ì„¤ì •í•  ë³€ìˆ˜
        // const horizontalMarginValue = '3px';
        //
        // // ë™ì ìœ¼ë¡œ ìƒì„±ëœ ìš”ì†Œë“¤ì„ ì„ íƒí•©ë‹ˆë‹¤.
        // const dynamicElements = document.querySelectorAll('.nav-user-info > *');
        //
        // // ê° ìš”ì†Œì— ê°€ë¡œ ë§ˆì§„ì„ ì„¤ì •í•©ë‹ˆë‹¤.
        // dynamicElements.forEach(element => {
        //     element.style.marginLeft = horizontalMarginValue;
        //     element.style.marginRight = horizontalMarginValue;
        // });
    }

    function initialize() {
        fetchLoginInfo();
    }

    initialize();
</script>
</html>